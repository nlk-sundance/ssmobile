var WPtouchWebApp=navigator.standalone;var addToHomeConfig={startDelay:550,lifespan:1000*60,expire:60*24*WPtouch.expiryDays,animationIn:'bubble',animationOut:'drop',touchIcon:true,message:WPtouch.add2home_message};if(typeof ontouchstart!='undefined'&&typeof ontouchend!='undefined'){var touchStartOrClick='touchstart',touchEndOrClick='touchend';}else{var touchStartOrClick='click',touchEndOrClick='click';};if(window.top!=window.self){window.top.location=self.location.href}
function doClassicReady(){jQuery.mobile.ajaxEnabled=false;jQuery(function(){var tabContainers=jQuery('#menu-container > div');var innerTabs=jQuery('#tab-inner-wrap-left a');innerTabs.click(function(){tabContainers.hide().filter(this.hash).show();innerTabs.removeClass('selected');jQuery(this).addClass('selected');return false;}).filter(':first').click();});jQuery('a#header-menu-toggle').click(function(){jQuery(this).toggleClass('menu-toggle-open');jQuery('#main-menu').opacityToggle(380);return false;});jQuery('#main-menu ul li a:not(li.has_children > a)').bind('click',function(){jQuery(this).parent().addClass('active');});jQuery('a#tab-search').click(function(){jQuery('#search-bar').toggleClass('show-search');jQuery(this).toggleClass('search-toggle-open');return false;});jQuery('#main-menu').find('li.has_children ul').hide();jQuery('#main-menu ul li.has_children > a').click(function(){jQuery(this).parent().children('ul').opacityToggle(380);jQuery(this).toggleClass('arrow-toggle');jQuery(this).parent().toggleClass('open-tree');return false;});if(jQuery('#prowl-message').length){setTimeout(function(){jQuery('#prowl-message').fadeOut(350);},2500);}
jQuery('.content img, .content .wp-caption').each(function(){if(!jQuery(this).hasClass('aligncenter')&&jQuery(this).width()>105){jQuery(this).addClass('aligncenter');}});jQuery('.single .p3-img-protect').each(function(){jQuery('.p3-overlay').remove();var insideContent=jQuery(this).html();jQuery(this).replaceWith(insideContent);});jQuery('a#share-toggle').click(function(e){jQuery('#share-links').opacityToggle(330);e.preventDefault();});jQuery('#action-buttons a, .comment-buttons a, a#cancel-comment-reply-link, a.com-toggle').bind(touchStartOrClick,function(){jQuery(this).addClass('active');}).bind(touchEndOrClick,function(){jQuery(this).removeClass('active');});jQuery('a#instapaper-toggle').click(function(e){var userName=prompt(WPtouch.instapaper_username,'');if(userName){var passWord=prompt(WPtouch.instapaper_password,'');if(!passWord){passWord='default';}
var ajaxParams={url:document.location.href,username:userName,password:passWord,title:document.title};WPtouchAjax('instapaper',ajaxParams,function(result){if(result=='1'){alert(WPtouch.instapaper_saved);}else{alert(WPtouch.instapaper_try_again);jQuery('a#instapaper-toggle').click();}});}
e.preventDefault();});jQuery('#email').find('a').click(function(){jQuery('a#share-toggle').click();return true;});jQuery('.commentlist li :first, .commentlist img.avatar:first').addClass('first');jQuery('a.com-toggle').bind('click',function(){jQuery('ol.commentlist').toggleClass('hidden');jQuery('img#com-arrow').toggleClass('com-arrow-down');return false;});if(jQuery(window).width()>=480){jQuery('body').addClass('landscape');}else{jQuery('body').addClass('portrait');}
window.onorientationchange=function(){var scrollPosition=jQuery('body').scrollTop()+1;var orientation=window.orientation;switch(orientation){case 0:case 180:jQuery('body').addClass('portrait').removeClass('landscape');window.scrollTo(0,scrollPosition,100);break;case 90:case-90:jQuery('body').addClass('landscape').removeClass('portrait');window.scrollTo(0,scrollPosition,100);break;default:jQuery('body').addClass('portrait').removeClass('landscape');}}
var header=jQuery('#header').get(0);header.addEventListener('touchmove',classicTouchMove,false);if(jQuery('#tab-bar').length){var tabBar=jQuery('#tab-bar').get(0);tabBar.addEventListener('touchmove',classicTouchMove,false);}
var postURL=document.location;var commentTextarea=jQuery('#commentform textarea');var CommentFormOptions={beforeSubmit:function(){commentTextarea.addClass('loading');},success:function(){commentTextarea.removeClass('loading').addClass('success');alert(WPtouch.comment_success);setTimeout(function(){commentTextarea.removeClass('success');},1500);},error:function(){commentTextarea.removeClass('loading').addClass('error');alert(WPtouch.comment_failure);setTimeout(function(){commentTextarea.removeClass('error');},3000);},resetForm:true,timeout:10000}
if(jQuery.isFunction(jQuery.fn.ajaxForm)){jQuery('#commentform').ajaxForm(CommentFormOptions);}
loadMoreEntries();loadMoreComments();comReplyArrows();classicExcerptToggle();welcomeMessage();webAppLinks();webAppOnly();handleVids();jQuery('a.login-req, a.comment-reply-login').bind('click',function(){jQuery('a#header-menu-toggle, a#tab-login').click();scrollTo(0,0,1);return false;});if(jQuery('body').hasClass('hide-addressbar')){jQuery(window).load(function(){setTimeout(function(){scrollTo(0,0)},1);});}
jQuery('a.back-to-top').click(function(){jQuery('body').animate({scrollTop:jQuery('html').offset().top},750);return false;});jQuery('a.middle-link').click(function(){jQuery('body').animate({scrollTop:jQuery('.nav-bottom').offset().top},750);return false;});jQuery(function(){var tabindex=1;jQuery('input, select, textarea').each(function(){if(this.type!="hidden"){var inputToTab=jQuery(this);inputToTab.attr('tabindex',tabindex);tabindex++;}});});var onLabel=WPtouch.toggle_on,offLabel=WPtouch.toggle_off;jQuery('.on').text(onLabel);jQuery('.off').text(offLabel);jQuery('#switch').find('div').bind(touchEndOrClick,function(){var switchURL=jQuery(this).attr('title');jQuery('.on').toggleClass('active');jQuery('.off').toggleClass('active');setTimeout(function(){window.location=switchURL},500);return false;});classicHandleShortcodes();if(jQuery('.mslide').size()>0){jQuery('#mdots a').each(function(i){jQuery(this).click(function(){if(jQuery(this).parent().hasClass('onn')==false){var isprev=jQuery('#mdots').hasClass('prev');var nex=jQuery('.mslide:eq('+i+')');nex.css('left',(isprev?'-':'')+'100%').show();var onn=jQuery('.mslide.onn');onn.add(nex).animate({left:(isprev?'+':'-')+'=100%'},600,function(){jQuery(this).toggleClass('onn');});jQuery(this).parent().addClass('onn').siblings('.onn').removeClass();}
jQuery('#mdots').removeClass('prev');return false;});});jQuery('body').on({swiperight:function(){jQuery('#mdots').addClass('prev');var onn=jQuery('#mdots .onn');var nex=onn.prev();if(nex.size()==0){nex=onn.parent().children(':last-child');}
nex.children('a').click();},swipeleft:function(){var onn=jQuery('#mdots .onn');var nex=onn.next();if(nex.size()==0){nex=onn.parent().children(':first-child');}
nex.children('a').click();}});}
if(jQuery('.tubslide').size()>0){jQuery('#mdots a').each(function(i){jQuery(this).click(function(){if(jQuery(this).parent().hasClass('onn')==false){var isprev=jQuery('#mdots').hasClass('prev');var nex=jQuery('.tubslide:eq('+i+')');nex.css('left',(isprev?'-':'')+'100%').show();var onn=jQuery('.tubslide.onn');onn.add(nex).animate({left:(isprev?'+':'-')+'=100%'},600,function(){jQuery(this).toggleClass('onn');});jQuery(this).parent().addClass('onn').siblings('.onn').removeClass();}
jQuery('#mdots').removeClass('prev');return false;});});jQuery('body').on({swiperight:function(){jQuery('#mdots').addClass('prev');var onn=jQuery('#mdots .onn');var nex=onn.prev();if(nex.size()==0){nex=onn.parent().children(':last-child');}
nex.children('a').click();},swipeleft:function(){var onn=jQuery('#mdots .onn');var nex=onn.next();if(nex.size()==0){nex=onn.parent().children(':first-child');}
nex.children('a').click();}});jQuery('.tubslide img.attachment-background').each(function(){var iw=jQuery(this).attr('width');var ih=jQuery(this).attr('height');var neww=Math.round(iw*229/ih);var lef=Math.floor((jQuery(window).width()-neww)/2)-41;jQuery(this).css({'height':229,'width':neww,'margin-left':lef+'px'});});}
if(jQuery('.post.cats .tubs').size()>0){if(jQuery('.post.post-8').size()>0){$('.post.cats .content').accordion({active:false,collapsible:true,heightStyle:"content"});}else{$('.post.cats .content').accordion({heightStyle:"content"});}}
if ( jQuery('.post-8').size() > 0 ) jQuery('a.mbtn.hottubs').hide();
jQuery('#dlzip').bind('focus',function(){if(jQuery(this).hasClass('locd')==false){jQuery(this).addClass('locd');navigator.geolocation.getCurrentPosition(jht_fposition);}});jht_geocoder=new google.maps.Geocoder();if(jQuery('#dltopform').size()>0){jQuery('#dlbtn').click(function(){navigator.geolocation.getCurrentPosition(jht_position);return false;}).trigger('click');jQuery('#dltopform').each(function(){jQuery(this).bind({'submit':function(){var dzip=jQuery('#dlzip').val();jQuery(this).trigger('dlloading');if(dzip!='Zip/Postal Code'){jQuery.ajax({type:"POST",url:'/dealer-locator/cities/',data:{"zipcodeSearch":1,"data[Dealer][country_id]":1,"zip":dzip},success:function(result){var dh3=jQuery(result).find('.dealerheader');var dinfo=dh3.next();jQuery('#dlandimg').hide();jQuery('#dmap-canvas').remove();jQuery('#dlrap').show().children().empty();dh3.appendTo('#dlresult');dinfo.appendTo('#dlresult');var pho=dinfo.find('.phone,.phone2');pho.each(function(){var htm=jQuery(this).html();jQuery(this).html('<a href="tel:'+htm+'" onclick="_gaq.push([\'_trackEvent\',\'DealerLocator\',\'click-to-call\',\'Mobile\']);" >'+htm+'</a>');});var daddr='';var dladdr1=dinfo.find('.address1');if(dladdr1.size()>0){daddr+=dladdr1.html();}
var dlcity=dinfo.find('.city');if(dlcity.size()>0){daddr+=', '+dlcity.html();}
var dlstate=dinfo.find('.state');if(dlstate.size()>0){daddr+=', '+dlstate.html();}
var dlzip=dinfo.find('.dzip');if(dlzip.size()>0){daddr+=' '+dlzip.html();}
var dmapd=jQuery('<div id="dmap-canvas"></div>');dmapd.insertBefore('#dlrap');jht_geocoder.geocode({'address':daddr},function(results,status){if(status==google.maps.GeocoderStatus.OK){var mapOptions={zoom:14,center:results[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById('dmap-canvas'),mapOptions);map.setCenter(results[0].geometry.location);var marker=new google.maps.Marker({map:map,position:results[0].geometry.location});jQuery('#dltopform').trigger('dldone');}else{alert("Geocode was not successful for the following reason: "+status);if(status=='ZERO_RESULTS'){jQuery('#dltopform').trigger('dlreset');}}});var daddrp=daddr.replace(/ /g,"+");var dbtns=jQuery('<div class="dbtns"><a href="http://maps.google.com/?saddr=&daddr='+daddrp+'" onclick="_gaq.push([\'_trackEvent\',\'DealerLocator\',\'Directions\',\'Mobile\']);">Directions</a><a href="/get-a-quote/" onclick="_gaq.push([\'_trackEvent\',\'DealerLocator\',\'Get-Quote\',\'Mobile\']);">Request a Quote</a></div>');dbtns.appendTo('#dlresult');jQuery(result).find('#truckd,#additional_html').appendTo('#dlresult');}});}
return false;},'dlloading':function(){jQuery('#dltopform input.dlsub').val('SEARCHING...').attr('disabled',true).addClass('offf');},'dlreset':function(){jQuery('#dlandimg').show().next();jQuery('#dmap-canvas').remove();jQuery('#dlrap').hide();jQuery('#dlzip').val('').blur();jQuery(this).trigger('dldone');},'dldone':function(){jQuery('#dltopform input.dlsub').val('SEARCH').removeAttr('disabled').removeClass('offf');}});if(jQuery(this).hasClass('zipposted')){jQuery(this).submit();}});}}
function classicTouchMove(e){e.preventDefault();}
jQuery.fn.opacityToggle=function(speed,easing,callback){return this.animate({opacity:'toggle'},speed,easing,callback);}
jQuery.fn.viewportCenter=function(){this.css('position','absolute');this.css('top',((jQuery(window).height()-this.outerHeight())/3)+jQuery(window).scrollTop()+'px');this.css('left',((jQuery(window).width()-this.outerWidth())/2)+jQuery(window).scrollLeft()+'px');this.show();return this;}
function welcomeMessage(){if(!WPtouchWebApp){jQuery('#welcome-message').show();jQuery('a#close-msg').bind('click',function(){WPtouchCreateCookie('wptouch_welcome','1',365);jQuery('#welcome-message').fadeOut(350);return false;});jQuery('#switch').show();}}
function webAppLinks(){if(WPtouchWebApp){var webAppLinks=jQuery('a').not('.no-ajax, .email a, .feed a, a#header-menu-toggle, .has_children > a, a.load-more-link, .load-more-comments-link a, a#share-toggle, .GTTabs a');webAppLinks.each(function(){var targetUrl=jQuery(this).attr('href'),targetLink=jQuery(this);var localDomain=location.protocol+'//'+location.hostname,rootDomain=location.hostname.split('.'),masterDomain=rootDomain[1]+'.'+rootDomain[2];if(typeof wptouch_ignored_urls!='undefined'){jQuery.each(wptouch_ignored_urls,function(i,val){if(targetUrl.match(val)){targetLink.addClass('ignored');}});}
if(targetUrl.match((/[^\s]+(\.(pdf|numbers|pages|xls|xlsx|doc|docx|zip|tar|gz|csv|txt))$/i))){targetLink.addClass('external');}else if(targetUrl.match((/[^\s]+(\.(jpg|jpeg|gif|png|bmp|tiff))$/i))){targetLink.addClass('img-link');}
jQuery(targetLink).unbind('click').bind('click',function(e){if(jQuery(targetLink).hasClass('external')||jQuery(targetLink).parent('li').hasClass('external')){confirmForExternal=confirm(WPtouch.external_link_text+' \n'+WPtouch.open_browser_text);if(confirmForExternal){return true;}else{return false;}}else if(jQuery(targetLink).hasClass('img-link')){return false;}else if(targetUrl.match(localDomain)||!targetUrl.match('http://')){if(jQuery(targetLink).hasClass('ignored')||jQuery(targetLink).parent('li').hasClass('ignored')){confirmForExternal=confirm(WPtouch.wptouch_ignored_text+' \n'+WPtouch.open_browser_text);if(confirmForExternal){return true;}else{return false;}}else{if(jQuery('#main-menu').hasClass('show-menu')){jQuery(this).opacityToggle(380);jQuery('a#header-menu-toggle').toggleClass('menu-toggle-open');}
loadPage(targetUrl);return false;}}else{confirmForExternal=confirm(WPtouch.external_link_text+' \n'+WPtouch.open_browser_text);if(confirmForExternal){return true;}else{return false;}}});});}else{jQuery('li.target a').attr('target','_blank');}}
function loadPage(targetUrl){var persistenceOn=jQuery('body.loadsaved').length;if(jQuery('body').hasClass('ajax-on')){jQuery('body').append('<div id="progress"></div>');jQuery('#progress').viewportCenter();jQuery(document).unbind();jQuery('#outer-ajax').load(targetUrl+' #inner-ajax',function(allDone){jQuery('#progress').addClass('done');if(persistenceOn){WPtouchCreateCookie('wptouch-load-last-url',targetUrl,365);}else{WPtouchEraseCookie('wptouch-load-last-url');}
doClassicReady();scrollTo(0,0,100);});}else{jQuery('body').append('<div id="progress"></div>');jQuery('#progress').viewportCenter();if(persistenceOn){WPtouchCreateCookie('wptouch-load-last-url',targetUrl,365);}
setTimeout(function(){window.location=targetUrl;},550);}}
function webAppOnly(){if(WPtouchWebApp){var persistenceOn=jQuery('body.loadsaved').length;if(!persistenceOn){WPtouchEraseCookie('wptouch-load-last-url');}
jQuery('body').addClass('web-app');jQuery('body.black-translucent').css('margin-top','20px');jQuery('a.comment-reply-link, a.comment-edit-link').remove();setTimeout(function(){jQuery('#progress').remove();},150);}}
function classicExcerptToggle(){jQuery('a.excerpt-button').live('click',function(){jQuery(this).toggleClass('open').parent('.post').find('.content').opacityToggle(380);return false;});}
function classicHandleShortcodes(){if(WPtouchWebApp){var webAppDivs=jQuery('.wptouch-shortcode-webapp-only');if(webAppDivs.length){webAppDivs.show();}}}
function loadMoreEntries(){var loadMoreLink=jQuery('a.load-more-link');var ajaxDiv='.ajax-page-target';loadMoreLink.live('click',function(){jQuery(this).addClass('ajax-spinner').text(WPtouch.loading_text);var loadMoreURL=jQuery(this).attr('rel');jQuery('#content').append("<div class='ajax-page-target'></div>");jQuery(ajaxDiv).hide().load(loadMoreURL+' #content .post, #content .load-more-link',function(){jQuery(this).replaceWith(jQuery(this).html());jQuery('a.load-more-link.ajax-spinner').fadeOut(350);webAppLinks();handleVids();});return false;});}
function loadMoreComments(){var loadMoreLink=jQuery('li.load-more-comments-link a');var ajaxDiv='.ajax-page-target';loadMoreLink.live('click',function(){jQuery(this).addClass('ajax-spinner');var loadMoreURL=jQuery(this).attr('href');jQuery('ol.commentlist').append("<div class='ajax-page-target'></div>");jQuery(ajaxDiv).hide().load(loadMoreURL+' ol.commentlist > li',function(){jQuery(this).replaceWith(jQuery(this).html());jQuery('.load-more-comments-link a.ajax-spinner').parent().fadeOut(350);if(WPtouchWebApp){jQuery('a.comment-reply-link, a.comment-edit-link').remove();webAppLinks();}});return false;});}
function comReplyArrows(){var comReply=jQuery('ol.commentlist li li > .comment-top');jQuery.each(comReply,function(){jQuery(comReply).prepend("<div class='com-down-arrow'></div>");});}
function handleVids(){if(jQuery.isFunction(jQuery.fn.fitVids)){jQuery('.content').fitVids();}
if(typeof window.coyierVids=='function'){coyierVids();}
if(jQuery('video').length){jQuery('video').attr('controls','controls');}}
function WPtouchCreateCookie(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}
else var expires="";document.cookie=name+"="+value+expires+"; path="+WPtouch.siteurl;}
function WPtouchEraseCookie(name){WPtouchCreateCookie(name,"",-1);}
jQuery(document).ready(function(){doClassicReady();});